# JavaScript 数据类型完整笔记

## 一、概述

JavaScript 是一种动态类型语言，拥有 **8 种基本数据类型**：

- 7 种原始类型（基本类型：Undefined、Null、Boolean、Number、String、Symbol、BigInt）
- 1 种对象类型（引用类型：Object）

## 二、原始类型（7种）

### 1. Undefined

- 表示变量已声明但未赋值
- 唯一值：`undefined`
- 特点：全局对象属性，不可写，不可配置，不可枚举

```javascript
let x;
console.log(x); // undefined
console.log(typeof x); // "undefined"
```

### 2. Null

- 表示空值或"无"的值
- 唯一值：`null`
- 特点：`typeof null`返回 `"object"`（历史遗留问题）

```javascript
let empty = null;
console.log(empty); // null
console.log(typeof empty); // "object" (注意这是历史遗留问题)
```

### 3. Boolean

- 表示逻辑值
- 两个值：`true`和 `false`
- 在条件判断中，所有值都可以转换为布尔值

```javascript
let isTrue = true;
极简实现let isFalse = false;
console.log(typeof isTrue); // "boolean"

// 假值: false, 0, "", null, undefined, NaN
// 真值: 其他所有值
```

### 4. Number

- 表示整数和浮点数
- 范围：±(2^53 - 1)
- 特殊值：`Infinity`, `-Infinity`, `NaN`

```javascript
let integer = 42;
let float = 3.14;
let hex = 0xFF; // 255
let exponential = 2e3; // 2000
let infinity = Infinity;
let notANumber = NaN;

console.log(typeof integer); // "number"
console.log(0.1 + 0.2); // 0.30000000000000004 (浮点数精度问题)
```

### 5. String

- 表示文本数据
- 使用单引号、双引号或反引号（模板字符串）
- 不可变：任何修改都会创建新字符串

```javascript
let single = 'Hello';
let double = "World";
let template = `Hello ${double}`; // Hello World
let multiLine = `This is a
multi-line string`;

console.log(typeof single); // "string"
console.log(single.length); // 5
```

### 6. Symbol (ES6)

- 表示唯一的、不可变的值
- 常用作对象属性的键，避免属性名冲突
- 描述符用于调试，不影响唯一性

```javascript
let sym1 = Symbol('description');
let sym2 = Symbol('description');
console.log(sym1 === sym2); // false

let obj = {
  [sym1]: "value"
};
console.log(obj[sym1]); // "value"
```

### 7. BigInt (极简实现ES2020)

- 表示任意精度的整数
- 后缀 `n`或使用 `BigInt()`函数创建
- 不能与 Number 类型混合运算

```javascript
let big1 = 1234567890123456789012345678901234567890n;
let big2 = BigInt("1234567890123456789012345678901234567890");

console.log(typeof big1); // "bigint"
console.log(big1 + big2); // 2469135780246913578024691357802469135780n
```

## 三、对象类型（1种）

### Object

- 键值对的集合
- 包括：普通对象、数组、函数、日期、正则表达式等
- 按引用比较，存储在堆内存中

```javascript
// 普通对象
let person = {
  name: "John",
  age: 30,
  isStudent: false
};

// 数组
let fruits = ["Apple", "Banana", "Orange"];

// 函数
function greet() {
  return "Hello";
}

// 日期
let now = new Date();

// 正则表达式
let pattern = /hello/i;

console.log(typeof person); // "object"
console.log(typeof fruits); // "object"
console.log(typeof greet); // "function" (特殊)
console.log(typeof now); // "object"
console.log(typeof pattern); // "object"
```

## 四、类型检测

### 1. typeof 操作符

```javascript
typeof undefined;        // "undefined"
typeof null;             // "object" (历史遗留问题)
typeof true;             // "boolean"
typeof 42;               // "number"
typeof "hello";          // "string"
typeof Symbol();         // "symbol"
typeof 123n;             // "bigint"
typeof {};               // "object"
typeof [];               // "object"
typeof function(){};     // "function"
```

### 2. instanceof 操作符

- 检测对象是否属于特定类
- 对原始类型无效

```javascript
[] instanceof Array;      // true
{} instanceof Object;     // true
new Date() instanceof Date; // true
"hello" instanceof String; // false (原始类型)
```

### 3. Object.prototype.toString.call()

- 最准确的类型检测方法

```javascript
Object.prototype.toString.call(undefined);    // "[object Undefined]"
Object.prototype.toString.call(null);         // "[object Null]"
Object.prototype.toString.call(true);         // "[object Boolean]"
Object.prototype.toString.call(极简实现42);           // "[object Number]"
Object.prototype.toString.call("hello");      // "[object String]"
Object.prototype.toString.call(Symbol());     // "[极简实现object Symbol]"
Object.prototype.toString.call(123n);         // "[object Big极简实现Int]"
Object.prototype.toString.call({});           // "[object Object]"
Object.prototype.toString.call([]);           // "[object Array]"
Object.prototype.toString.call(function(){}); // "[object Function]"
Object.prototype.toString.call(new Date());   // "[object Date]"
```

## 五、类型转换

### 1. 显式转换

```javascript
// 转换为数字
Number("123");    // 123
Number("abc");    // NaN
parseInt("123");  // 123
parseFloat("3.14"); // 3.14

// 转换为字符串
String(123);      // "123"
(123).toString(); // "123"

// 转换为布尔值
Boolean(1);       // true
Boolean(0);       // false
Boolean("");      // false
Boolean("hello"); // true
```

### 2. 隐式转换

```javascript
// 数学运算中的转换
"5" - 2;      // 3 (字符串转换为数字)
"5" + 2;      // "52" (数字转换为字符串)

// 布尔上下文中的转换
if (0) {}      // false
if ("hello") {} // true
if (null) {}   // false
if (undefined) {} // false

// 相等比较中的转换
"5" == 5;      // true (类型转换后比较)
"5" === 5;     // false (严格比较，类型不同)
```

## 六、数据类型特点对比

| 特性         | 原始类型     | 对象类型         |
| ------------ | ------------ | ---------------- |
| **可变性**   | 不可变       | 可变             |
| **存储方式** | 栈内存       | 堆内存           |
| **比较方式** | 按值比较     | 按引用比较       |
| **赋值行为** | 创建值的副本 | 复制引用（指针） |
| **内存管理** | 自动回收     | 垃圾回收机制     |

## 七、特殊值和注意事项

### 1. NaN (Not-a-Number)

```javascript
console.log(typeof NaN); // "number"
console.log(NaN === NaN); // false
console.log(isNaN(NaN)); // true
console.log(Number.isNaN(NaN)); // true (ES6)
```

### 2. null 与 undefined

```javascript
console.log(null == undefined); // true
console.log(null === undefined); // false

// 最佳实践：明确区分使用
let variable; // 未赋值，使用 undefined
let emptyValue = null; // 明确设置为空值
```

### 3. 浮点数精度问题

```javascript
console.log(0.1 + 0.2); // 极简实现0.30000000000000004
console.log(0.1 + 0.2 === 0.3); // false

// 解决方案：使用整数运算或专用库
console.log((0.1 * 10 + 0.2 * 10) / 10); // 0.3
```

## 八、ES6+ 新增特性

### 1. Symbol

```javascript
// 创建全局Symbol
let globalSym = Symbol.for('global');
console.log(Symbol.keyFor(globalSym)); // "global"

// 内置Symbol
let arr = [1, 2, 3];
console.log(arr[Symbol.iterator]); // function
```

### 2. BigInt

```javascript
// 与Number的互操作
let big = 123n;
let num = 456;

console.log(big + BigInt(num)); // 579n
console.log(Number(big) + num); // 579

// 类型检查
console.log(typeof 123n); // "bigint"
console.log(Object.prototype.toString.call(123n)); // "[object BigInt]"
```

### 3. 模板字符串

```javascript
let name = "John";
let age = 30;

// 多行字符串
let multiLine = `Hello,
My name is ${name}.
I'm ${age} years old.`;

// 标签模板
function tag(strings, ...values) {
  console.log(strings); // ["Hello ", "!"]
  console.log(values); // ["John"]
  return "Processed";
}

let result = tag`Hello ${name}!`;
console.log(result); // "Processed"
```

## 九、最佳实践

1. **使用严格相等**：优先使用 `===`和 `!==`避免类型转换问题
2. **明确类型转换**：使用显式转换而非依赖隐式转换
3. **处理浮点数精度**：注意浮点数运算的精度问题，必要时使用整数运算
4. **区分null和undefined**：`null`表示空极简实现值，`undefined`表示未定义
5. **使用现代类型检测**：优先使用 `Object.prototype.toString.call()`或 ES6+ 方法

```javascript
// 类型检查函数
function getType(value) {
  return Object.prototype.toString.call(value).slice(8, -1);
}

console.log(getType(42)); // "Number"
console.log(getType("hello")); // "String"
console.log(getType([])); // "Array"
console.log(getType(null)); // "Null"
```

## 十、总结

JavaScript 的 8 种数据类型包括 7 种原始类型和 1 种对象类型：

1. **原始类型**：Undefined、Null、Boolean、Number、String、Symbol、BigInt
   - 不可变，按值比较，存储在栈内存中
   - 赋值时创建值的副本
2. **对象类型**：Object
   - 可变，按引用比较，存储在堆内存中
   - 包括：普通对象、数组、函数、日期、正则表达式等
   - 赋值时复制引用（指针）

理解这些数据类型的特点、行为差异和转换规则对于编写高质量 JavaScript 代码至关重要。在实际开发中，应根据需求选择合适的数据类型，并注意原始类型和对象类型在行为上的差异。